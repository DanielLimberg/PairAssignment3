---
title: "An odd relation: National Equity Prices and GDP Growth"
author: "Limberg, Daniel & Mueller, Lukas"
date: "April 2016"
output: pdf_document
---

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
# Descriptive & Inferential Statistics
library(stargazer)
library(Rmisc)
library(ggplot2)
library(magrittr)
library(grid)


# Set Working Directory
try(setwd("/Users/Lukas/Documents/Git/PairAssignment3/"),silent=TRUE)
try(setwd("C:/Users/Dani/Documents/GitHub2/PairAssignment3/"),silent=TRUE)
getwd()


# Dynamical Link to first R script file
source("PairAssignment3_Code/PairAssignment3_Variables_LagsPercChanges.R")
```

# To Do

Mention Var?
Control for S&P 500?
Movement of Global markets?
Role of market sentiments?

# Introduction

Focusing on four OECD countries (Germany, France, Great Britain and Japan) we investigate whether there are different levels of statistical significance   

# Research Question and Hypothesis

Are there different levels of statistical significance for the effect of a nation's GDP growth on national equity prices?

H~0~: There are no differences regarding statistical significance for the effect of a nation's GDP on national equity prices. 
H~1~: There are differences regarding statistical significance for the effect of a nation's GDP on national equity prices.

# Descriptive Statistics

## Dependent Variable (Equity Prices): Plotting the course over time

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
### Germany
p1 <- ggplot(data = merge10, aes(x = Date, y = DAX.Close)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Germany | DAX") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "Av. Closing Value") + theme(legend.position="none") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) 
### Japan
p2 <- ggplot(data = merge10, aes(x = Date, y = NIK.Close)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Japan | NIKKEI") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "Av. Closing Value") + theme(legend.position="none") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) 
### France
p3 <- ggplot(data = merge10, aes(x = Date, y = CAC.Close)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("France | CAC40") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "Av. Closing Value") + theme(legend.position="none") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) 
### Great Britain
p4 <- ggplot(data = merge10, aes(x = Date, y = FTSE.Close)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Great Britain | FTSE") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "Av. Closing Value") + theme(legend.position="none") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) 
```

```{r, echo=FALSE}
multiplot(p1, p2, p3, p4, cols = 2)
```


## Key Independent Variable: Quarterly GDP growth 

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
farben <- c("firebrick1", "mediumspringgreen", "deepskyblue2", "chocolate4", "cyan2")
### Germany
p5 <- ggplot(data = merge10, aes(x = Date, y = DEU.GDP)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Germany") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "% Change") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) + theme(legend.position="none")
### Japan
p6 <- ggplot(data = merge10, aes(x = Date, y = JPN.GDP)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Japan") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "% Change") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) + theme(legend.position="none")
### France
p7 <- ggplot(data = merge10, aes(x = Date, y = FRA.GDP)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("France") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "% Change") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) + theme(legend.position="none")
### Great Britain
p8 <- ggplot(data = merge10, aes(x = Date, y = GBR.GDP)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("Great Britain") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "% Change") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) + theme(legend.position="none")
### USA
p9 <- ggplot(data = merge10, aes(x = Date, y = USA.GDP)) + geom_line() + scale_x_continuous(breaks=seq(1991.1, 2015.4, 10)) + ggtitle("USA") + theme(plot.title = element_text(size=10)) + labs(x = "Quarters", y = "% Change") + theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) + theme(legend.position="none")
```

```{r, echo=FALSE}
multiplot(p5, p6, p7, p8, p9, cols = 2)
```

## Measures of Central Tendency for Dependent Variables

```{r, echo=FALSE}
### N, Mean St. Deviations, Min and Max for all Variables
stargazer(merge10, type = "text", title="Descriptive statistics", digits=1)
```

### Mean

```{r, echo=FALSE}
for (i in 3:6) {
  merge10[, i] %>% 
    mean() %>%
    paste(names(merge10)[i], ., "\n") %>%
    cat()
}
```

### Median

```{r, echo=FALSE}
for (i in 3:6) {
  merge10[, i] %>% 
    median() %>%
    paste(names(merge10)[i], ., "\n") %>%
    cat()
}
```

### Standard Dev.

```{r, echo=FALSE}
for (i in 3:6) {
  merge10[, i] %>% #Error: could not find function "%>%"
    sd() %>%
    paste(names(merge10)[i], ., "\n") %>%
    cat()
}
```

## Distribution of Dependent Variables: Average Closing Values

```{r, echo=FALSE}
par(mfrow=c(2,2))
hist(merge10$DAX.Close,
     main="Germany | DAX", 
     col="black", 
     breaks = 15,
     xlab = "Average Closing Values",
     ylab = "Frequency")
hist(merge10$CAC.Close,
     main="France | CAC", 
     col="black", 
     breaks = 15,
     xlab = "Average Closing Values",
     ylab = "Frequency")
hist(merge10$NIK.Close,
     main="Japan | Nikkei", 
     col="black", 
     breaks = 15,
     xlab = "Average Closing Values",
     ylab = "Frequency")
hist(merge10$FTSE.Close,
     main="Great Britain | FTSE", 
     col="black", 
     breaks = 15,
     xlab = "Average Closing Values",
     ylab = "Frequency")
```

## Joint Distributions of DV and Key IV (no lag)

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
##DEU
p15 <- ggplot(merge10, aes(x = DEU.GDP, y = DAX.Close)) + 
  geom_point() + 
  geom_smooth() +
  ggtitle("Germany") +
  xlab("GDP Growth") +
  ylab("DAX Av. Closing Value") +
  theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) +
  theme(plot.title = element_text(size=10)) 

## JPN
p16 <- ggplot(merge10, aes(x = JPN.GDP, y = NIK.Close)) + 
  geom_point() + 
  geom_smooth() +
  ggtitle("Japan") +
  xlab("GDP Growth") +
  ylab("Nikkei Av. Closing Value") +
  theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) +
  theme(plot.title = element_text(size=10)) 

## FRA
p17 <- ggplot(merge10, aes(x = FRA.GDP, y = CAC.Close)) + 
  geom_point() + 
  geom_smooth() +
  ggtitle("France") +
  xlab("GDP Growth") +
  ylab("CAC Av. Closing Value") +
  theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) +
  theme(plot.title = element_text(size=10)) 

## GBR
p18 <- ggplot(merge10, aes(x = GBR.GDP, y = FTSE.Close)) + 
  geom_point() + 
  geom_smooth() +
  ggtitle("Great Britain") +
  xlab("GDP Growth") +
  ylab("FTSE Av. Closing Value") +
  theme(axis.text=element_text(size=8),
        axis.title=element_text(size=8)) +
  theme(plot.title = element_text(size=10)) 
```

```{r, echo=FALSE}
multiplot(p15, p16, p17, p18, cols = 2)
```

# Inferential Statistics

## Basic Model: OLS

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
summary(M1 <- lm(DAX.Close ~ DEU.GDP, data = merge10))
summary(M2 <- lm(NIK.Close ~ JPN.GDP, data = merge10))
summary(M3 <- lm(CAC.Close ~ FRA.GDP, data = merge10))
summary(M4 <- lm(FTSE.Close ~ GBR.GDP, data = merge10))
```

```{r, echo=FALSE}
stargazer(M1, M2, M3, M4, type="text", dep.var.labels=c("DAX","Nikkei", "CAC", "FTSE"),
          covariate.labels=c("GDP Growth"))
```

### Heteroscedasticity Diagnose 

```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(M1, which = 1)
  title("Germany")
plot(M2, which = 1)
  title("Japan")
plot(M3, which = 1)
  title("France")
plot(M4, which = 1)
  title("Britain")
```

### Diagnose of non-normality of Errors

```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(M1, which = 2)
  title("Germany")
plot(M2, which = 2)
  title("Japan")
plot(M3, which = 2)
  title("France")
plot(M4, which = 2)
  title("Britain")
```

## Expanded Model: OLS

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
summary(M5 <- lm(DAX.Close ~ DEU.GDP + L.DEU.unempl + L.DEU.prvconsm + L.ECB.MRO.change + L.ECB.dep.change + L.WTI.dollar.change + L.Brent.dollar.change, data = merge10))
  
summary(M6 <- lm(NIK.Close ~ JPN.GDP + L.JPN.unempl + L.JPN.prvconsm + L.ECB.MRO.change + L.ECB.dep.change + L.WTI.dollar.change + L.Brent.dollar.change, data = merge10))

summary(M7 <- lm(CAC.Close ~ FRA.GDP + L.FRA.unempl + L.FRA.prvconsm + L.ECB.MRO.change + L.ECB.dep.change + L.WTI.dollar.change + L.Brent.dollar.change, data = merge10))

summary(M8 <- lm(FTSE.Close ~ GBR.GDP + L.GBR.unempl + L.GBR.prvconsm + L.ECB.MRO.change + L.ECB.dep.change + L.WTI.dollar.change + L.Brent.dollar.change, data = merge10))
```

```{r, echo=FALSE}
stargazer(M5, M6, M7, M8, type="text", dep.var.labels=c("DAX","Nikkei", "CAC", "FTSE"),
          covariate.labels=c("GDP Growth", "Unemployment lagged", "Consumption Spending lagged", "ECB MRO lagged", "ECB Depos. Facility lagged"))
```

## Heteroscedasticity Diagnose

```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(M5, which = 1)
title("Germany")
plot(M6, which = 1)
title("Japan")
plot(M7, which = 1)
title("France")
plot(M8, which = 1)
title("Britain")
```

## Diagnose of non-normality of Errors

```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(M5, which = 2)
title("Germany")
plot(M6, which = 2)
title("Japan")
plot(M7, which = 2)
title("France")
plot(M8, which = 2)
title("Britain")
```

# Panel Model: Pooled OLS

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}

summary(P1 <- lm(DAX.Close ~ DEU.GDP + L.DEU.unempl + L.DEU.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year, data = merge10))

summary(P2 <- lm(NIK.Close ~ JPN.GDP + L.JPN.unempl + L.JPN.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year, data = merge10))

summary(P3 <- lm(CAC.Close ~ FRA.GDP + L.FRA.unempl + L.FRA.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year, data = merge10))

summary(P4 <- lm(FTSE.Close ~ GBR.GDP + L.GBR.unempl + L.GBR.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year, data = merge10))
```

```{r, echo=FALSE}
stargazer(P1, P2, P3, P4, type="text", dep.var.labels=c("DAX","Nikkei", "CAC", "FTSE"),
          covariate.labels=c("GDP Growth", "Unemployment lagged", "Consumption Spending lagged", "ECB MRO lagged", "ECB Depos. Facility lagged", "WTI lagged", "Brent lagged", "Year"))
```

## Confidence Intervals

```{r, echo=FALSE}
confint(P1)
confint(P2)
confint(P3)
confint(P4)
```

## Heteroscedasticity Diagnose

```{r, echo=FALSE}
#par(mfrow=c(2,2))

#plot(P1, which = 1)
#title("Germany")

#plot(P2, which = 1)
#title("Japan")

#plot(P3, which = 1)
#title("France")

#plot(P4, which = 1)
#title("Britain")
```

## Diagnose of non-normality of Errors

```{r, echo=FALSE}
#par(mfrow=c(2,2))

#plot(P1, which = 2)
#title("Germany")

#plot(P2, which = 2)
#title("Japan")

#plot(P3, which = 2)
#title("France")

#plot(P4, which = 2)
#title("Britain")
```

# Inferential Statistics - US ecomomy

```{r, echo=FALSE, message=FALSE, include=FALSE, cache=FALSE}
M9 <- lm(DAX.Close ~ DEU.GDP + L.DEU.unempl + L.DEU.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year + USA.GDP, data = merge10)

M10 <- lm(NIK.Close ~ JPN.GDP + L.JPN.unempl + L.JPN.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year + USA.GDP, data = merge10)

M11 <- lm(CAC.Close ~ FRA.GDP + L.FRA.unempl + L.FRA.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year + USA.GDP, data = merge10)

M12 <- lm(FTSE.Close ~ GBR.GDP + L.GBR.unempl + L.GBR.prvconsm + L.ECB.MRO.change + L.ECB.dep.change  + L.WTI.dollar.change + L.Brent.dollar.change + year + USA.GDP, data = merge10)
```

```{r, echo=FALSE}
stargazer(M9, M10, M11, M12, type="text", dep.var.labels=c("DAX","Nikkei", "CAC", "FTSE"),
covariate.labels=c("GDP Growth", "Unemployment lagged", "Consumption Spending lagged", "ECB MRO lagged", "ECB Depos. Facility lagged", "WTI lagged", "Brent lagged", "Year", "USA.GDP"))
```

## Confidence Intervals

```{r, echo=FALSE}
confint(M9)
confint(M10)
confint(M11)
confint(M12)
```

## Heteroscedasticity Diagnose

```{r, echo=FALSE}
#par(mfrow=c(2,2))
#plot(M9, which = 1)
#title("Germany")
#plot(M10, which = 1)
#title("Japan")
#plot(M11, which = 1)
#title("France")
#plot(M12, which = 1)
#title("Britain")
```

## Diagnose of non-normality of Errors

```{r, echo=FALSE}
#par(mfrow=c(2,2))
#plot(M9, which = 2)
#title("Germany")
#plot(M10, which = 2)
#title("Japan")
#plot(M11, which = 2)
#title("France")
#plot(M12, which = 2)
#title("Britain")
```
